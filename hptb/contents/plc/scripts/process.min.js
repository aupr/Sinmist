var preprocess=function(){plcUserId="admin";plcPassword="";plcTag={vfd_start:'"Control".VFD_Control.Write_To_G120.Start',vfd_stop:'"Control".VFD_Control.Write_To_G120.Stop',vfd_frequency:'"Control".VFD_Control.Write_To_G120."Set Frequency"',emfm_1_minLimit:'"Control".Flow_Meters.Electro_Magnetic."1"."Min Limit"',emfm_1_maxLimit:'"Control".Flow_Meters.Electro_Magnetic."1"."Max Limit"',emfm_2_minLimit:'"Control".Flow_Meters.Electro_Magnetic."2"."Min Limit"',emfm_2_maxLimit:'"Control".Flow_Meters.Electro_Magnetic."2"."Max Limit"',emfm_3_minLimit:'"Control".Flow_Meters.Electro_Magnetic."3"."Min Limit"',emfm_3_maxLimit:'"Control".Flow_Meters.Electro_Magnetic."3"."Max Limit"',emfm_4_minLimit:'"Control".Flow_Meters.Electro_Magnetic."4"."Min Limit"',emfm_4_maxLimit:'"Control".Flow_Meters.Electro_Magnetic."4"."Max Limit"',kgv_1_position:'"Control".Knife_Gate_Valve."1".Input',kgv_2_position:'"Control".Knife_Gate_Valve."2".Input',kgv_3_position:'"Control".Knife_Gate_Valve."3".Input',kgv_4_position:'"Control".Knife_Gate_Valve."4".Input',pt_1_minLimit:'"Control".PressureTransmitters."1"."Min Limit"',pt_1_maxLimit:'"Control".PressureTransmitters."1"."Max Limit"',pt_2_minLimit:'"Control".PressureTransmitters."2"."Min Limit"',pt_2_maxLimit:'"Control".PressureTransmitters."2"."Max Limit"',pt_3_minLimit:'"Control".PressureTransmitters."3"."Min Limit"',pt_3_maxLimit:'"Control".PressureTransmitters."3"."Max Limit"',pt_4_minLimit:'"Control".PressureTransmitters."4"."Min Limit"',pt_4_maxLimit:'"Control".PressureTransmitters."4"."Max Limit"',pt_5_minLimit:'"Control".PressureTransmitters."5"."Min Limit"',pt_5_maxLimit:'"Control".PressureTransmitters."5"."Max Limit"',pt_6_minLimit:'"Control".PressureTransmitters."6"."Min Limit"',pt_6_maxLimit:'"Control".PressureTransmitters."6"."Max Limit"',pt_7_minLimit:'"Control".PressureTransmitters."7"."Min Limit"',pt_7_maxLimit:'"Control".PressureTransmitters."7"."Max Limit"',pt_8_minLimit:'"Control".PressureTransmitters."8"."Min Limit"',pt_8_maxLimit:'"Control".PressureTransmitters."8"."Max Limit"',pt_9_minLimit:'"Control".PressureTransmitters."9"."Min Limit"',pt_9_maxLimit:'"Control".PressureTransmitters."9"."Max Limit"',pt_10_minLimit:'"Control".PressureTransmitters."10"."Min Limit"',pt_10_maxLimit:'"Control".PressureTransmitters."10"."Max Limit"'};var a="Login="+plcUserId+"&Password="+plcPassword;$.post("/FormLogin",a,function(b){console.log("Access & Login PLC: Success")}).fail(function(){console.log("Access & Login PLC: Failed")});$("body").css({"background-color":"black"});$("nav .logo").css({"background-image":"url('"+server+"contents/images/logo.png')"});isProcess=0;window.onbeforeunload=function(){if(isProcess>0){return true}else{}}};var process=function(){var a={mode:"Auto",process:"Stopped",pipeDia:4,vp:56,nvp:59,frm:555,fru:555,motor:"Stopped",freq:50,rpm:1000,power:30,current:100};viewSystemStatus(a);bindControlBoxButtons()};var mainData=[];var dummyData=[{vo:41,sp:90,dp:87,frm:80,fru:98,men:87,mfq:66},{vo:42,sp:90,dp:87,frm:70,fru:98,men:87,mfq:66},{vo:43,sp:90,dp:87,frm:90,fru:98,men:87,mfq:66},{vo:44,sp:90,dp:87,frm:60,fru:98,men:87,mfq:66}];function updateDataTable(a){a.sort(function(d,c){return d.frm-c.frm});$("#dataViewTable").html("");a.forEach(function(c,b){b=b+1;$("#dataViewTable").append(" <tr><td>"+b+"</td><td>"+c.vo+"</td><td>"+c.sp+"</td><td>"+c.dp+"</td><td>"+c.frm+"</td><td>"+c.fru+"</td><td>"+c.men+"</td><td>"+c.mfq+"</td></tr>")})}function bindControlBoxButtons(){$("#cb-start-process").click(startProcessHit);$("#cb-take-data").click(takeDataHit);$("#cb-emergency").click(emergencyHit)}function cbOptionsDisabled(a){$("input","#processMode").prop("disabled",a);$("#valveOpenBy").prop("disabled",a)}var startProcessHit=function(){$("#cb-start-process").css({display:"none"});$("#cb-take-data").css({display:"block"});cbOptionsDisabled(true)};var takeDataHit=function(){$("#cb-emergency").css({display:"block"});updateDataTable(dummyData);systemLog("Data hit pressed ... ","#system-log");var a=plcTag.pt_1_maxLimit+"=10";$.post("limit.html",a,function(b){console.log(b)},"json")};var emergencyHit=function(){$("#cb-emergency").css({display:"none"});$("#cb-start-process").css({display:"block"});cbOptionsDisabled(false);$.get("data.html?"+plcTag.vfd_stop+"=1",function(a){console.log(a)},"json")};function viewSystemStatus(a){$("#status-mode").html(a.mode);$("#status-process").html(a.process);$("#status-pipe-dia").html(a.pipeDia);$("#status-valve-position").html(a.vp);$("#status-flow-rate-m").html(a.frm);$("#status-flow-rate-u").html(a.fru);$("#status-next-vp").html(a.nvp);$("#status-motor").html(a.motor);$("#status-freq").html(a.freq);$("#status-rpm").html(a.rpm);$("#status-power").html(a.power);$("#status-current").html(a.current)}function scrollUp(a){$(a).scrollTop(a.prop("scrollHeight"))}logLimit=5000;txt="";logNum=0;function systemLog(d,a){a=$(a);logNum++;var c=new Date();var b=c.getFullYear()+"-"+c.getMonth()+1+"-"+c.getDate()+" > "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();if(txt===""){txt+=logNum+" > "+b+" > "+d}else{txt+="\r\n"+logNum+" > "+b+" > "+d}var e=txt.split("\r\n");sptLen=e.length;if(sptLen>logLimit){e=e.slice(sptLen-logLimit,sptLen)}txt=e.join("\r\n");a.val(txt);scrollUp(a)};